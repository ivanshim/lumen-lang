# Comprehensive String Processing Example
# Demonstrates combining multiple string_ord_chr functions for practical tasks

print("=== Text Processing Pipeline ===")
print("")

# Example 1: Password strength validator
print("Password Strength Validator:")

fn has_digit_char(s)
    digit_i = 0
    while digit_i < len(s)
        if is_digit(char_at(s, digit_i))
            return true
        digit_i = digit_i + 1
    false

fn has_alpha_char(s)
    alpha_i = 0
    while alpha_i < len(s)
        if is_alpha(char_at(s, alpha_i))
            return true
        alpha_i = alpha_i + 1
    false

fn has_upper_char(s)
    upper_i = 0
    c = ""
    o = 0
    while upper_i < len(s)
        c = char_at(s, upper_i)
        o = ord(c)
        if o >= ord("A") and o <= ord("Z")
            return true
        upper_i = upper_i + 1
    false

fn has_lower_char(s)
    lower_i = 0
    c = ""
    o = 0
    while lower_i < len(s)
        c = char_at(s, lower_i)
        o = ord(c)
        if o >= ord("a") and o <= ord("z")
            return true
        lower_i = lower_i + 1
    false

fn validate_password(pwd)
    print("  Password: '" . pwd . "'")

    if len(pwd) < 8
        print("    WEAK: Too short (minimum 8 characters)")
        return false

    if not has_digit_char(pwd)
        print("    WEAK: Must contain at least one digit")
        return false

    if not has_alpha_char(pwd)
        print("    WEAK: Must contain at least one letter")
        return false

    if not has_upper_char(pwd)
        print("    WEAK: Must contain at least one uppercase letter")
        return false

    if not has_lower_char(pwd)
        print("    WEAK: Must contain at least one lowercase letter")
        return false

    print("    STRONG: All requirements met")
    return true

passwords = ["abc123", "PASSWORD123", "Pass123", "MyP@ssw0rd"]
pwd_i = 0
while pwd_i < len(passwords)
    validate_password(passwords[pwd_i])
    pwd_i = pwd_i + 1
print("")

# Example 2: Extract and sum numbers from text
print("Extract and Sum Numbers from Text:")

fn extract_all_numbers(s)
    numbers = []
    current_num = ""
    extract_i = 0
    c = ""

    while extract_i < len(s)
        c = char_at(s, extract_i)
        if is_digit(c)
            current_num = current_num . c
        else
            if len(current_num) > 0
                push(numbers, string_to_value(current_num))
                current_num = ""
        extract_i = extract_i + 1

    # Don't forget last number if string ends with a digit
    if len(current_num) > 0
        push(numbers, string_to_value(current_num))

    numbers

fn sum_numbers_in_text(s)
    nums = extract_all_numbers(s)
    sum = 0
    sum_i = 0
    while sum_i < len(nums)
        sum = sum + nums[sum_i]
        sum_i = sum_i + 1
    sum

texts = [
    "I have 5 apples and 3 oranges",
    "Order #123 total: 45 items",
    "No numbers here",
    "Year 2025 day 17"
]
text_i = 0
text = ""
sum = 0
while text_i < len(texts)
    text = texts[text_i]
    sum = sum_numbers_in_text(text)
    print("  '" . text . "'")
    print("    Sum: " . value_to_string(sum))
    text_i = text_i + 1
print("")

# Example 3: Normalize and compare strings
print("Normalize and Compare Strings:")

fn normalize_string(s)
    # Convert to lowercase and remove non-alphanumeric manually
    lower = string_to_lower(s)
    result = ""
    normalize_i = 0
    c = ""
    while normalize_i < len(lower)
        c = char_at(lower, normalize_i)
        if is_alnum(c)
            result = result . c
        normalize_i = normalize_i + 1
    result

fn strings_match_normalized(a, b)
    normalize_string(a) == normalize_string(b)

pairs = [
    ["Hello World", "hello world"],
    ["Test-123", "TEST123"],
    ["Lumen Lang", "LumenLang"],
    ["Different", "Strings"]
]
pair_i = 0
a = ""
b = ""
match = false
while pair_i < len(pairs)
    a = pairs[pair_i][0]
    b = pairs[pair_i][1]
    match = strings_match_normalized(a, b)
    print("  '" . a . "' vs '" . b . "': " . value_to_string(match))
    pair_i = pair_i + 1
print("")

# Example 4: Generate acronym from phrase
print("Generate Acronym from Phrase:")

fn generate_acronym(phrase)
    words = []
    current_word = ""
    acronym_i = 0
    c = ""

    # Split by spaces
    while acronym_i < len(phrase)
        c = char_at(phrase, acronym_i)
        if c == " "
            if len(current_word) > 0
                push(words, current_word)
                current_word = ""
        else
            current_word = current_word . c
        acronym_i = acronym_i + 1

    # Add last word
    if len(current_word) > 0
        push(words, current_word)

    # Take first letter of each word
    acronym = ""
    acronym_j = 0
    word = ""
    while acronym_j < len(words)
        word = words[acronym_j]
        if len(word) > 0
            acronym = acronym . char_to_upper(char_at(word, 0))
        acronym_j = acronym_j + 1

    acronym

phrases = [
    "As Soon As Possible",
    "Frequently Asked Questions",
    "Light Amplification by Stimulated Emission of Radiation",
    "You Only Live Once"
]
phrase_i = 0
phrase = ""
acronym = ""
while phrase_i < len(phrases)
    phrase = phrases[phrase_i]
    acronym = generate_acronym(phrase)
    print("  '" . phrase . "' -> " . acronym)
    phrase_i = phrase_i + 1
print("")

# Example 5: Simple Caesar cipher
print("Simple Caesar Cipher (letters only, shift by 3):")

fn caesar_shift_char(c)
    if not is_alpha(c)
        return c

    o = ord(c)
    if o >= ord("a") and o <= ord("z")
        # Lowercase: shift within a-z
        shifted = ((o - ord("a") + 3) % 26) + ord("a")
        chr(shifted)
    else
        # Uppercase: shift within A-Z
        shifted = ((o - ord("A") + 3) % 26) + ord("A")
        chr(shifted)

fn caesar_encrypt(s)
    result = ""
    caesar_i = 0
    c = ""
    o = 0
    shifted = 0
    while caesar_i < len(s)
        c = char_at(s, caesar_i)
        if not is_alpha(c)
            result = result . c
        else
            o = ord(c)
            if o >= ord("a") and o <= ord("z")
                # Lowercase: shift within a-z
                shifted = ((o - ord("a") + 3) % 26) + ord("a")
                result = result . chr(shifted)
            else
                # Uppercase: shift within A-Z
                shifted = ((o - ord("A") + 3) % 26) + ord("A")
                result = result . chr(shifted)
        caesar_i = caesar_i + 1
    result

messages = ["hello world", "LUMEN LANG", "Test 123"]
msg_i = 0
msg = ""
encrypted = ""
while msg_i < len(messages)
    msg = messages[msg_i]
    encrypted = caesar_encrypt(msg)
    print("  '" . msg . "' -> '" . encrypted . "'")
    msg_i = msg_i + 1
